<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-spring4-4.dtd">

<html lang="en"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4"
      xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/head"/>

<body>

<!-- Barra de Navegación superior -->
<body> <!-- Barra de Navegación superior -->
<nav th:replace="fragments/nav"/>
<div class="container" id="main-container">
    <h2>Publicaciones</h2>
    <form action="/post/list" class="form-inline">
        <div class="form-group"><input class="form-control" name="searchText"
                                       placeholder="Buscar publicaciones de un amigo" size="50"
                                       type="text"></div>
        <button class="btn btn-primary" type="submit">Buscar</button>
    </form>



    <button class="btn btn-default" id="updateButton" type="button">Actualizar</button>
    <!--Debemos preparar el script para incluir parámetros Thymeleaft (incluimos el th:inline=“javascript” y el CDATA).-->
    <script th:inline="javascript"> /*<![CDATA[*/
    $("#updateButton").click(function () {
        var numberPage = [[${param.page}]];
        var urlUpdate = '/mark/list/update';
        if (numberPage != null) {
            urlUpdate += "?page=" + numberPage[0];
        }
        $("#tableMarks").load(urlUpdate);
    }); /*]]>*/ </script>

    <!--Al pulsarlo se realiza una llamada con JQUERY a la URL /list/update sustituyendo el contenido antiguo
    de la tabla por el que acaba de obtener (usando la función l oad)-->

    <div class="table-responsive">
        <!--Al especificar el fragmento. este será lo unico que se actualice-->
        <table class="table table-hover" id="tableMarks" th:fragment="tableMarks">
            <thead>
            <tr>
                <th scope="col">Fecha</th>
                <th scope="col">Título</th>
                <th scope="col">Descripción</th>
                <th scope="col"></th>
                <th scope="col"></th>
                <th scope="col"></th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="post ${postList}">
                <td scope="row" th:text="${post.dateOfCreation}"> 23/09/2021</td>
                <td th:text="${post.títle}">10</td>
                <td th:text="${post.description}"> Ejercicio 1</td>

            </tr>
            </tbody>
        </table>
    </div>
    <div th:if="${#lists.isEmpty(postList)}"> No posts available.</div>
</div>

</div>
<footer th:replace="fragments/pagination"/>
</div>
<footer th:replace="fragments/footer"/>
</body>
</html>
